#!/usr/bin/env bash

indent() {
    sed -u 's/^/      /'
}

BUILD_DIR=$1
CACHE_DIR=$2
ENV_DIR=$3

echo "pre copy root LS"
echo $(ls)

export SUBPATH = $(cat ${ENV_DIR}/APP_SUBFOLDER)
APP_SUBFOLDER=$(cat ${ENV_DIR}/APP_SUBFOLDER)

if [[ -z "${APP_SUBFOLDER}" ]]; then
    echo "APP_SUBFOLDER was not set. Aborting" | indent
    exit 1
fi

echo "APP_SUBFOLDER: " $APP_SUBFOLDER
echo $(ls $SUBPATH)

echo "post copy root LS"
echo $(ls)

echo "BUILD_DIR: " $BUILD_DIR
echo "CACHE_DIR: " $CACHE_DIR
echo "ENV_DIR: " $ENV_DIR

cp -r ${BUILD_DIR}/${APP_SUBFOLDER}/* ${BUILD_DIR}/

echo "Copied all files successfully" | indent
